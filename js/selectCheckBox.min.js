(function($){var _global;function SelectCheckBox(obj,op){this.obj=obj;this.ops={};this._initial(this.obj,op)}SelectCheckBox.prototype={_initial:function(obj,options){var defaults={hasInput:false,inputTips:"请选择",checkAllTips:"全选",has_cehecked_all:"已全选",checkAll:true,menuValue:[],valName:"",showName:"",titleName:"",isOpen:false,hasChange:false,activeBgColor:"#519fec",callBack:function(res){}};var that=obj;var _this=this;var ops=_this.ops=$.extend({},defaults,options);ops.is_more=this.ops.is_more=true;function creatSelect(){var tag="",secondMenu='<div class="selectMenu2">',showname=ops.showName,titlename=ops.titleName,checkAll=ops.checkAll;if(!ops.hasInput){tag+='<input  placeholder="'+ops.inputTips+'" class="select-input" type="text"   readonly="1" >'}var checked=checkAll?"checked":"";tag+='<div class="selectMenu1">';tag+='<div class="select_level1 select_all" data-val=" "><input type="checkbox" '+checked+' class="check_all">'+ops.checkAllTips+"</div>";$.each(ops.menuValue,function(index,val){tag+='<div class="select_level1" data-val="'+index+'" title="'+index+'">';tag+='<input type="checkbox" name="check_first" '+checked+' class="check_first">';tag+=index+"</div>";secondMenu+='<div class="select_wrap2">';$.each(val,function(i,val1){if(!ops.is_more||typeof val1==="string"){ops.is_more=_this.ops.is_more=false;var more_val="title='"+val1+"'";var val2=val1;var data_name=val1}else{var data_name=i;var arr1=Object.values(val1);var len1=arr1.length;if(len1>1){var val2=arr1[0];var more_val="";for(var k in arr1){more_val+=" data-val"+k+'="'+arr1[k]+'"'}}else{var val2=arr1[0];var more_val="data-val='"+arr1[0]+"'"}if(titlename!==""){more_val+='title="'+val1[titlename]+' "'}else{more_val+='title="'+val2+' "'}if(showname!==""){val2=val1[showname]}}secondMenu+='<div class="select_level2" data-name="'+data_name+'"  '+more_val+">";secondMenu+='<input type="checkbox" value="'+val2+'" name="check_second" class="check_second" '+checked+">";secondMenu+=val2+"</div>"});secondMenu+="</div>"});tag+="</div>";secondMenu+="</div>";tag+=secondMenu;$(that).append(tag);addStyle();open();through($(that).find(".select_level1"),true);through($(that).find(".select_level2"));selected()}function through(obj,isOne){$(obj).mouseenter(function(){$(obj).siblings().css({backgroundColor:"#fff",color:"#000"});$(this).css({backgroundColor:ops.activeBgColor,color:"#fff"});if(isOne){var index=($(this).index()-1);$(that).find(".select_wrap2").hide();if(index>=0){$($(that).find(".select_wrap2").eq(index)).show()}}})}function open(){$(that).delegate(".select-input","click",function(e){var ishidden=$(that).find(".selectMenu1").is(":hidden");$(".selectMenu1,.select_wrap2").hide();if(ishidden){if($(that).hasClass("drop")){$(that).removeClass("drop").addClass("upward")}$(that).find(".selectMenu1").show();ops.isOpen=true}else{if($(that).hasClass("upward")){$(that).removeClass("upward").addClass("drop")}$(that).find(".selectMenu1").hide();ops.isOpen=false}e.stopPropagation()});$(document).delegate(":not('.check_first,.check_second')","click",function(){if(ops.isOpen){if($(that).hasClass("upward")){$(that).removeClass("upward").addClass("drop")}if(ops.hasChange){getValues(this)}$(that).find(".selectMenu1,.select_wrap2").hide();ops.isOpen=false}})}function addStyle(){var source_len=$(that).find(".select_wrap2").length;$(that).find(".select_wrap2").each(function(i,ele){var level1_len=$(ele).find(".select_level2").length;if(i>source_len/2&&((level1_len>source_len/2||level1_len>4)&&level1_len<source_len)){var cur_pos=source_len-level1_len+1}else{if((source_len>10&&level1_len>source_len/2)||(level1_len+2)>source_len){var cur_pos=0}else{var cur_pos=(i+1)}}var top=cur_pos*23;$(ele).css("marginTop",top)})}function selected(){$(that).delegate(".select_level2","click",function(e){if($(this).find(".check_second").prop("checked")){$(this).find(".check_second").prop("checked",false)}else{var index=$(this).parent().index()+1;$($(that).find(".select_level1").eq(index)).find(".check_first").prop("checked",true);$(this).find(".check_second").prop("checked",true)}e.stopPropagation();ops.hasChange=true});$(that).delegate(".select_level2 .check_second","click",function(e){$(this).parents(".select_wrap2").show();$(that).find(".selectMenu1").show();if($(this).prop("checked")){var index=$(this).parents(".select_wrap2").index()+1;$($(that).find(".select_level1").eq(index)).find(".check_first").prop("checked",true)}e.stopPropagation();ops.hasChange=true});$(that).delegate(".select_level1","click",function(e){var index=($(this).index()-1);var source_level1=$(this).text();if($(this).find(".check_first").prop("checked")){$(this).find(".check_first").prop("checked",false);$($(that).find(".select_wrap2").eq(index)).find(".select_level2 .check_second").prop("checked",false)}else{$(this).find(".check_first").prop("checked",true);$($(that).find(".select_wrap2").eq(index)).find(".select_level2 .check_second").prop("checked",true)}e.stopPropagation();ops.hasChange=true});$(that).delegate(".select_level1 .check_first","click",function(e){var index=($(this).parent().index()-1);
        $($(that).find(".select_wrap2").eq(index)).show();$(that).find(".selectMenu1").show();$($(that).find(".select_wrap2").eq(index)).find(".select_level2").trigger("click");e.stopPropagation();ops.hasChange=true});$(that).delegate(".select_all","click",function(e){if($(this).find(".check_all").prop("checked")){$(this).find(".check_all").prop("checked",false);$(that).find(".check_first,.check_second").prop("checked",false)}else{$(this).find(".check_all").prop("checked",true);$(that).find(".check_first,.check_second").prop("checked",true)}e.stopPropagation();ops.hasChange=true});$(that).delegate(".select_all .check_all","click",function(e){$(that).find(".selectMenu1").show();if($(this).prop("checked")){$(that).find(".check_first,.check_second").prop("checked",true)}else{$(that).find(".check_first,.check_second").prop("checked",false)}e.stopPropagation();ops.hasChange=true})}function getValues(obj){var has_cehecked_all=ops.has_cehecked_all,all=false;var len=$(that).find(".check_second").length;var values=[];var arr_name="";$(that).find(".check_second:checked").each(function(i,ele){values.push($(ele).val());if(i===0){arr_name=$(ele).parent().text()}});var arr_len=values.length;if(len===arr_len){all=true;$(that).find(".select-input").val(has_cehecked_all)}else{if(arr_len===1){$(that).find(".select-input").val(arr_name)}else{if(arr_len>0){$(that).find(".select-input").val("已选择"+arr_name+"等"+arr_len+"项")}else{$(that).find(".select-input").val("未进行选择")}}}ops.callBack(values,that,obj,all);ops.hasChange=false}creatSelect()},has_selected:function(val){var that=this.obj;var ops=this.ops;var has_cehecked_all=ops.has_cehecked_all;if(val!==""){if(val==="all"){$(that).find(".check_first,.check_second").prop("checked",true);$(that).find(".select-input").val(has_cehecked_all)}else{var new_name="";$(that).find(".select_wrap2 .check_second").each(function(i,ele){if($(ele).val()===val){var index=($(ele).parents("select_wrap2").index()+1);$(ele).prop("checked",true);$($(that).find(".select_level1").eq(index)).find(".check_first").prop("checked",true);new_name=$(ele).parent().text()}});$(that).find(".select-input").val(new_name)}}}};_global=(function(){return this||(0,eval)("this")}());if(typeof module!=="undefined"&&module.exports){module.exports=SelectCheckBox}else{if(typeof define==="function"&&define.amd){define(function(){return SelectCheckBox})}else{!("SelectCheckBox" in _global)&&(_global.SelectCheckBox=SelectCheckBox)}}})(jQuery);