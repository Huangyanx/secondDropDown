(function($){var _global;function SelectPlug(obj,op){this.obj=obj;this.ops={};this._initial(this.obj,op)}SelectPlug.prototype={_initial:function(obj,options){var defaults={hasInput:false,inputTips:"请选择",menuValue:[],valName:"",valPos:"",showName:"",activeBgColor:"#519fec",callBack:function(res){}};var that=obj;var _this=this;var ops=_this.ops=$.extend({},defaults,options);ops.is_more=this.ops.is_more=true;function creatSelect(){var tag="",secondMenu='<div class="selectMenu2">',valpos=ops.valPos,showName=ops.showName;if(!ops.hasInput){tag+='<input  placeholder="'+ops.inputTips+'" class="select-input" type="text"   readonly="1" >'}tag+='<div class="selectMenu1">';$.each(ops.menuValue,function(index,val){tag+='<div class="select_level1" data-val="'+index+'" title="'+index+'">';tag+=index+"</div>";secondMenu+='<div class="select_wrap2">';$.each(val,function(i,val1){if(!ops.is_more||typeof val1==="string"){ops.is_more=_this.ops.is_more=false;var more_val="title='"+val1+"'";var val2=val1;var data_name=val1}else{var data_name=i;var arr1=Object.values(val1);var len1=arr1.length;if(len1>1){var val2=showName===""?arr1[0]:val1[showName];var more_val="";for(var k in arr1){more_val+=" data-val"+k+'="'+arr1[k]+'"'}}else{var val2=showName===""?arr1[0]:val1[showName];var more_val="data-val='"+arr1[0]+"'"}if(valpos!==""){more_val+=" title='"+arr1[valpos]+"'"}}secondMenu+='<div class="select_level2" data-name="'+data_name+'"  '+more_val+">";secondMenu+=val2+"</div>"});secondMenu+="</div>"});tag+="</div>";secondMenu+="</div>";tag+=secondMenu;$(that).append(tag);addStyle();open();through($(that).find(".select_level1"),true);through($(that).find(".select_level2"));_this.has_selected()}function through(obj,isOne){$(obj).mouseenter(function(){$(obj).siblings().css({backgroundColor:"#fff",color:"#000"});$(this).css({backgroundColor:ops.activeBgColor,color:"#fff"});if(isOne){var index=$(this).index();$(that).find(".select_wrap2").hide();$($(that).find(".select_wrap2").eq(index)).show()}})}function open(){$(that).delegate("input","click",function(e){var ishidden=$(that).find(".selectMenu1").is(":hidden");$(".selectMenu1,.select_wrap2").hide();if(ishidden){if($(that).hasClass("drop")){$(that).removeClass("drop").addClass("upward")}$(that).find(".selectMenu1").show()}else{if($(that).hasClass("upward")){$(that).removeClass("upward").addClass("drop")}$(that).find(".selectMenu1").hide()}e.stopPropagation()});$("html").delegate("","click",function(){$(that).find(".selectMenu1,.select_wrap2").hide()})}function addStyle(){var source_len=$(that).find(".select_wrap2").length;$(that).find(".select_wrap2").each(function(i,ele){var level1_len=$(ele).find(".select_level2").length;var cur_pos=((level1_len+2)>source_len||(source_len>10&&level1_len>source_len/2))?0:i;var top=cur_pos*23;$(ele).css("marginTop",top)})}creatSelect()},has_selected:function(val,is_name){var that=this.obj;var ops=this.ops;if(typeof val==="undefined"){$(that).delegate(".select_level2","click",function(e){if(!ops.is_more){var val=$(this).text()}else{if(ops.valPos!==""){var val=$(this).data("val"+ops.valPos)}else{if($(this).data("val")){var val=$(this).data("val")}else{var val=$(this).text()}}}if($(that).hasClass("drop")){$(that).removeClass("drop").addClass("upward")}else{if($(that).hasClass("upward")){$(that).removeClass("upward").addClass("drop")}}$(that).find("input").val(val);ops.callBack($(this).data("name"),that,this)});$(that).delegate(".select_level1","click",function(e){var source_level2=$(this).text();var index=$(this).index();if(!ops.is_more){var val=Object.values(ops.menuValue[source_level2])[0]}else{var val=ops.valName!==""?Object.values(ops.menuValue[source_level2])[0][ops.valName]:Object.values(Object.values(ops.menuValue[source_level2])[0])[0]}if($(that).hasClass("drop")){$(that).removeClass("drop").addClass("upward")}else{if($(that).hasClass("upward")){$(that).removeClass("upward").addClass("drop")}}$(that).find("input").val(val);var val_id=Object.keys(ops.menuValue[source_level2])[0];ops.callBack(val_id,this,$(that).find(".selectMenu2 .select_level1").eq(index))})}else{that.find(".select_level2").each(function(i,ele){if(is_name){if($(ele).data("name")==val){$(ele).trigger("click");return false}}else{if(ops.valPos!==""){if($(ele).data("val"+ops.valPos)===val){$(ele).trigger("click");return false}}else{if($(ele).text()===val){$(ele).trigger("click");return false}}}})}}};_global=(function(){return this||(0,eval)("this")}());if(typeof module!=="undefined"&&module.exports){module.exports=SelectPlug}else{if(typeof define==="function"&&define.amd){define(function(){return SelectPlug})}else{!("SelectPlug" in _global)&&(_global.SelectPlug=SelectPlug)}}})(jQuery);